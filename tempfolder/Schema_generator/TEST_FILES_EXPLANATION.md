# Test Files Explanation

This document explains the three main test/verification scripts for the Schema System.

---

## 1. `quick_test.py` - Quick End-to-End Test

**Purpose:** Fast, simple test to verify the complete workflow works.

**What it does:**
1. **Creates a test file** - Generates `test_quick.json` with sample product data (3 products with id, name, price, in_stock fields)
2. **Runs Schema Generator (Program A)** - Analyzes the JSON file and generates SQL `CREATE TABLE` statement
3. **Saves SQL to database** - Stores the generated SQL in the `schema_jobs` table with status 'pending'
4. **Runs Schema Executor (Program B)** - Fetches pending jobs and executes the SQL statements
5. **Verifies table creation** - Checks if the table was successfully created in the PostgreSQL database

**Use when:**
- You want to quickly verify the system is working after setup
- You need to test if database connection is working
- You want a simple demonstration of the workflow

**Example output:**
```
[OK] Database: clustro at localhost:5432
[OK] Created test file: test_quick.json
[OK] Schema generated successfully!
[OK] Table 'test_quick' exists in database!
```

---

## 2. `test_schema_system.py` - Comprehensive Test Suite

**Purpose:** Full end-to-end testing with multiple file types and complex scenarios.

**What it does:**
1. **Creates multiple test files** - Generates a `test_files_schema/` directory with:
   - `users.json` - Simple flat JSON structure (SQL-friendly)
   - `users_nested.json` - Complex nested JSON with objects and arrays (tests foreign key relationships)
   - `products.csv` - Tabular CSV data
   - `employees.xml` - Hierarchical XML structure
   
2. **Processes all files** - Runs Schema Generator on each file type
3. **Shows generated SQL** - Displays all SQL statements for review
4. **Executes all jobs** - Runs Schema Executor to create all tables
5. **Verifies results** - Checks job status and reports success/failure for each

**Use when:**
- You want comprehensive testing of all file formats
- You need to test nested structures and foreign keys
- You want to see how the system handles different data types
- You're doing regression testing after code changes

**Example output:**
```
Tables detected: 3
SQL statements generated: 3
Jobs created in schema_jobs: 3
Total jobs: 9
[OK] Completed: 9
[ERROR] Failed: 0
```

**Note:** This script will recreate `test_files_schema/` directory if it doesn't exist, but keeping the directory speeds up repeated tests.

---

## 3. `verify_tables.py` - Database Verification Utility

**Purpose:** Simple utility to check what tables exist in the database.

**What it does:**
1. **Connects to database** - Uses `config.py` to get database connection settings
2. **Queries PostgreSQL** - Checks `information_schema.tables` for all tables in the 'public' schema
3. **Lists all tables** - Shows all tables that were created by the schema system

**Use when:**
- You want to see what tables were created after running tests
- You need to verify if a specific table exists
- You're debugging and want to check database state
- You want a quick overview of your database schema

**Example output:**
```
[OK] Tables created in database:
  - employee
  - employee_department
  - employee_name
  - employee_salary
  - products
  - schema_jobs
  - test_quick
  - users
  - users_nested
  - users_nested_address
  - users_nested_orders
```

---

## Test File Workflow

### Recommended Testing Sequence:

1. **First time setup:**
   ```powershell
   python database_setup.py    # Setup database and schema_jobs table
   python quick_test.py        # Quick verification everything works
   ```

2. **Comprehensive testing:**
   ```powershell
   python test_schema_system.py    # Full test with all file types
   python verify_tables.py         # See what tables were created
   ```

3. **Development/debugging:**
   ```powershell
   python verify_tables.py    # Check current state
   # Make code changes
   python quick_test.py       # Quick test of changes
   ```

---

## Files Kept for Testing

- ✅ `quick_test.py` - Essential quick test
- ✅ `test_schema_system.py` - Essential comprehensive test
- ✅ `verify_tables.py` - Essential verification utility
- ✅ `test_files_schema/` - Test data directory (recreated if missing, but kept for speed)

## Files Removed (Not Needed)

- ❌ `test_quick.json` - Auto-generated by quick_test.py
- ❌ `test_files/` - For classifier testing, not schema system
- ❌ `test_classifier.py` - Classifier test (separate component)
- ❌ `test_connection.py` - Redundant (connection tested in other scripts)
- ❌ `test_unknown_files.py` - Redundant test

---

## Summary

| File | Purpose | When to Use |
|------|---------|-------------|
| `quick_test.py` | Quick workflow test | Fast verification, simple testing |
| `test_schema_system.py` | Comprehensive test suite | Full testing, all file types, regression testing |
| `verify_tables.py` | Database inspection | Debugging, verifying table creation |

All three files are necessary for complete testing:
- **quick_test.py** = Fast verification
- **test_schema_system.py** = Comprehensive testing
- **verify_tables.py** = Database inspection

